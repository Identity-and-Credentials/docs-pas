---
title: VMware Tanzu Application Service for VMs v2.13 Release Notes
owner: Release Engineering
---

This topic contains release notes for VMware Tanzu Application Service for VMs (TAS for VMs) v2.13.

TAS for VMs is certified by the Cloud Foundry Foundation for <%= Date.today.year %>.

For more information about the Cloud Foundry Certified Provider Program, see
[How Do I Become a Certified Provider?](https://www.cloudfoundry.org/certified-platforms-how-to/)
on the Cloud Foundry website.

Because VMware uses the Percona Distribution for MySQL, expect a time lag between Oracle
releasing a MySQL patch and VMware releasing TAS for VMs containing that patch.

<hr>

## <a id='releases'></a> Releases

<%# DO NOT DELETE THIS LINE - robots use this to add new release notes %>

### <a id='2.13.0'></a> 2.13.0

**Release Date:** March 29, 2022

* See [New Features in TAS for VMs v2.13](#new-features).
* See [Breaking Changes](#breaking-changes).
* See [Known Issues](#known-issues).

<table border="1" class="nice">
  <thead>
    <tr>
      <th>Component</th>
      <th>Version</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>ubuntu-xenial stemcell</td><td>621.211</td></tr>
    <tr><td>backup-and-restore-sdk</td><td>1.18.34</td></tr>
    <tr><td>binary-offline-buildpack</td><td>1.0.42</td></tr>
    <tr><td>bosh-dns-aliases</td><td>0.0.4</td></tr>
    <tr><td>bosh-system-metrics-forwarder</td><td>0.0.21</td></tr>
    <tr><td>bpm</td><td>1.1.16</td></tr>
    <tr><td>capi</td><td>1.127.0</td></tr>
    <tr><td>cf-autoscaling</td><td>248</td></tr>
    <tr><td>cf-cli</td><td>1.38.0</td></tr>
    <tr><td>cf-networking</td><td>3.3.0</td></tr>
    <tr><td>cflinuxfs3</td><td>0.274.0</td></tr>
    <tr><td>credhub</td><td>2.9.9</td></tr>
    <tr><td>diego</td><td>2.58.1</td></tr>
    <tr><td>dotnet-core-offline-buildpack</td><td>2.3.38</td></tr>
    <tr><td>garden-runc</td><td>1.20.0</td></tr>
    <tr><td>go-offline-buildpack</td><td>1.9.38</td></tr>
    <tr><td>haproxy</td><td>11.9.3</td></tr>
    <tr><td>java-offline-buildpack</td><td>4.48</td></tr>
    <tr><td>log-cache</td><td>2.11.5</td></tr>
    <tr><td>loggregator</td><td>106.6.2</td></tr>
    <tr><td>loggregator-agent</td><td>6.3.8</td></tr>
    <tr><td>mapfs</td><td>1.2.6</td></tr>
    <tr><td>metric-registrar</td><td>1.2.4</td></tr>
    <tr><td>metrics-discovery</td><td>3.0.8</td></tr>
    <tr><td>mysql-monitoring</td><td>9.15.0</td></tr>
    <tr><td>nats</td><td>43</td></tr>
    <tr><td>nfs-volume</td><td>7.1.1</td></tr>
    <tr><td>nginx-offline-buildpack</td><td>1.1.34</td></tr>
    <tr><td>nodejs-offline-buildpack</td><td>1.7.66</td></tr>
    <tr><td>notifications</td><td>62</td></tr>
    <tr><td>notifications-ui</td><td>40</td></tr>
    <tr><td>php-offline-buildpack</td><td>4.4.55</td></tr>
    <tr><td>push-apps-manager-release</td><td>676.0.1</td></tr>
    <tr><td>push-offline-docs-release</td><td>1.0.33</td></tr>
    <tr><td>push-usage-service-release</td><td>674.0.23</td></tr>
    <tr><td>pxc</td><td>0.41.0</td></tr>
    <tr><td>python-offline-buildpack</td><td>1.7.49</td></tr>
    <tr><td>r-offline-buildpack</td><td>1.1.25</td></tr>
    <tr><td>routing</td><td>0.231.0</td></tr>
    <tr><td>ruby-offline-buildpack</td><td>1.8.50</td></tr>
    <tr><td>silk</td><td>3.3.0</td></tr>
    <tr><td>smb-volume</td><td>3.1.0</td></tr>
    <tr><td>smoke-tests</td><td>4.5.0</td></tr>
    <tr><td>staticfile-offline-buildpack</td><td>1.5.28</td></tr>
    <tr><td>statsd-injector</td><td>1.11.18</td></tr>
    <tr><td>syslog</td><td>11.7.7</td></tr>
    <tr><td>system-metrics-scraper</td><td>3.2.4</td></tr>
    <tr><td>uaa</td><td>74.5.34</td></tr>
  </tbody>
</table>


## <a id='upgrade'></a> How to Upgrade

To upgrade to TAS for VMs v2.13, see [Configuring TAS for VMs for Upgrades](https://docs.pivotal.io/application-service/2-12/operating/configuring.html).

When upgrading to TAS for VMs v2.13, be aware of the following upgrade considerations:

* If you previously used an earlier version of TAS for VMs, you must first upgrade to TAS for VMs v2.11 to successfully upgrade to TAS for VMs v2.13.

* Some partner service tiles might be incompatible with TAS for VMs v2.13.
  VMware is working with partners to ensure their tiles are updated to work with the latest versions of TAS for VMs.
  <br/><br/> For information about which partner service releases are currently compatible with TAS for VMs
  v2.13, review the appropriate partners services release documentation
  at [https://docs.pivotal.io](https://docs.pivotal.io) or contact the partner organization that produces the tile.


## <a id='new-features'></a> New Features in TAS for VMs v2.13

TAS for VMs v2.13 includes the following major features:

### <a id='app-protocol'></a> Update the Destination App Protocol for Routes

With cf CLI v8, developers can update the destination protocol for app routes.
After the destination protocol is updated, the app uses that protocol for all incoming and outgoing communications.

To update the destination app protocol:

```
cf update-destination --app-protocol PROTOCOL APP-NAME APP-DOMAIN --hostname HOSTNAME
```

Where:

- `PROTOCOL` is the app protocol you want to use. You can use `http1` or `http2`.
- `APP-NAME` is the name of your app. For example, `my-app`.
- `APP-DOMAIN` is the domain name of your app. For example, `app-domain.com`.
- `HOSTNAME` is the hostname of your app. For example, `my-hostname`.

For example:

<pre class="terminal">
  $ cf update-destination --app-protocol http2 my-app app-domain.com --hostname my-hostname

  Destination-protocol changed to http2
  OK
</pre>

The command above updates the destination protocol for "my-app" to HTTP/2.

### <a id='mysql-8'></a> TAS for VMs is Compatible with MySQL 8

TAS for VMs v2.13.0 supports MySQL 8 for external databases.
Previous versions of TAS for VMs supported MySQL 5.7, which is expected to go out of support in 2023.
If you use an external MySQL database with TAS for VMs v2.13, use a MySQL 8 database for improved security and a longer window of support.

### <a id='golang-1-17'></a> TAS for VMs Components Use Golang v1.17

In TAS for VMs v2.13.0, several TAS for VMs components use Golang v1.17.

The following table lists the component releases that have been upgraded to use Golang v1.17:

<table class="nice">
  <tr>
    <th>Release Name</th>
    <th>First version that uses Golang v1.17</th>
  </tr>
  <tr>
    <td>cf-networking</td>
    <td>2.43.0</td>
  </tr>
  <tr>
    <td>silk</td>
    <td>2.43.0</td>
  </tr>
  <tr>
    <td>diego</td>
    <td>2.53.1</td>
  </tr>
  <tr>
    <td>nats</td>
    <td>41</td>
  </tr>
  <tr>
    <td>garden-runc</td>
    <td>1.19.31</td>
  </tr>
  <tr>
    <td>routing</td>
    <td>0.229.0</td>
  </tr>
</table>

For important information, see [Gorouter Certificates Require a SAN Extension](#certs-require-san) in the _Breaking Changes_ section.

### <a id='dynamic-asg'></a> Dynamic App Security Group Rules

TAS for VMs v2.13 introduces dynamic App Security Groups (ASGs).

ASGs are a collection of egress rules that specify the protocols, ports, and IP address ranges where app or task instances send traffic.
Previously, updating an existing ASG required you to restart the app before the ASG went into effect.

Dynamic ASGs can automatically update security groups without requiring an app restart.
If you have existing ASGs, you can run any of the security group cf CLI commands, including `cf bind-security-group` and `update-security-group`, and the changes apply automatically to any running apps.

For more information about ASGs, see [App Security Groups](../concepts/asg.html).

### <a id='scaling-factors'></a> Configure Scaling Factors for App Autoscaler

In TAS for VMs v2.13.0, App Autoscaler can scale apps by one or more app instances based on autoscaling rules.
In previous releases of TAS for VMs, App Autoscaler only scaled app instances up or down by one instance at a time.
You can configure scaling factors using the App Autoscaler API or the App Autoscaler CLI plugin.

To configure scaling factors using the API, see [Update an App Binding](https://docs.pivotal.io/application-service/2-13/appsman-services/autoscaler/using-autoscaler-api.html#update-app) in _Using the App Autoscaler API_.

To configure scaling factors using the App Autoscaler CLI plugin, see [Update Scaling Factors](https://docs.pivotal.io/application-service/2-13/appsman-services/autoscaler/using-autoscaler-cli.html#updating-scaling-factors) in _Using the App Autoscaler CLI_.

For more information, see [About App Autoscaler](https://docs.pivotal.io/application-service/2-13/appsman-services/autoscaler/about-app-autoscaler.html).

### <a id='separate-log-cache'></a> Log Cache Uses Its Own Instance Group

In TAS for VMs v2.13.0, the Log Cache component runs on its own Log Cache instance group. Log Cache is no longer part of Doppler instances. Additionally, syslog ingress is enabled by default.

This change allows TAS for VMs to do the following:

* Enable Log Cache to scale independently from Doppler. For example, to provide more memory for storing logs and metrics. You can reduce the memory allocation for Doppler instances.
* Scale Log Cache to more than 40 VMs, because it is no longer limited by Doppler and TrafficController's throughput and connection-based horizontal scaling limits.
* Reduce the number of network hops required for logs and metrics to get to Log Cache.

For important information, see the related [Breaking Change](#log-metric-topology).

### <a id='no-recreate'></a> Rotate the Root CA and NATS CA Without Re-Creating All VMs

In [Ops Manager v2.10.20](https://docs.pivotal.io/ops-manager/2-10/release-notes.html#2-10-20) and later, operators can rotate the root certificate authority (CA) or NATS CA without re-creating all VMs.
If you rotate these certificates in Ops Manager and click **Apply Changes**, Ops Manager updates the certificates on the VMs without re-creating the VMs.

For more information, see [Rotating CAs and Leaf Certificates](https://docs.pivotal.io/ops-manager/2-10/security/pcf-infrastructure/rotate-cas-and-leaf-certs.html) in the Ops Manager documentation.

### <a id='imdsv2'></a> Enable IMDSv2 in Ops Manager on AWS

Operators can configure [Ops Manager v2.10.23](https://docs.pivotal.io/ops-manager/2-10/release-notes.html#2-10-23) and later to require IMDSv2 on all BOSH-deployed VMs in Amazon Web Services (AWS).
This Ops Manager feature is compatible with installations of TAS for VMs v2.13.0 and later.

For more information, see [Enable IMDSv2 in Ops Manager](https://docs.pivotal.io/ops-manager/2-10/security/security-adjacent/security-guidelines-iaas.html#aws-imds-v2) in the Ops Manager documentation.

### <a id='tls-c2c'></a> Enable One-Way TLS for Container-to-Container Communication

In TAS for VMs v2.13.0, developers can enable TLS for communication between app containers. <%# how? %>

When you enable this feature, TLS is terminated at Envoy.
Developers can continue to serve HTTP traffic on port 8080, and Envoy listens on port 61443 with a TLS certificate with a SAN that includes app internal routes.
Envoy proxies this port to port 8080 inside the container.
When a new route is mapped to the app, the certificate without requiring an app restart.

### <a id='offline-tools'></a> Download Offline Tools in Air-Gapped Environments

In TAS for VMs v2.13.0, you can include documentation and cf CLI packages in Apps Manager that operators and developers can download in air-gapped environments.
TAS for VMs v2.13.0 adds the post-deploy **Offline Docs Errand**.

To enable access to offline tools in air-gapped environments:

1. Navigate to the Installation Dashboard and click the TAS for VMs tile.
1. Select **Apps Manager**.
1. Under **Configure how developers access documentation, tools and pluggins when unable to connect to the internet**, select the checkbox for **Enable access to offline tools**.
1. Under **Choose which CF CLI packages to include**, select either **CF CLI V7** or **CF CLI V8**.
1. Click **Save**.
1. Select **Errands**.
1. Under **Offline Docs Errand**, select **On** from the dropdown.
1. Click **Save**.
1. Return to the Installation Dashboard.
1. Click **Review Pending Changes**.
1. Review the changes, and then click **Apply Changes**.

For more information, see [(Optional) Configure Custom Branding and Apps Manager](https://docs.pivotal.io/application-service/2-13/operating/configure-pas.html#customize-apps-man) in _Configuring TAS for VMs_.


## <a id='breaking-changes'></a> Breaking Changes

TAS for VMs v2.13 includes the following breaking changes:

### <a id='log-metric-topology'></a> Log and Metric Topology Changes

In TAS for VMs v2.13, the Log Cache component runs on its own Log Cache instance group. Log Cache is no longer part of Doppler instances.

As a result of this change, Diego Cells with high logging volume might experience higher CPU usage than they did prior to this change.

When you upgrade to TAS for VMs v2.13, you might experience temporary difficulties getting logs and metrics from the cf CLI for apps that are pushed during the upgrade.
This should not affect whether or not the app is able to be deployed.

This change comes with the following considerations when you upgrade to TAS for VMs v2.13:

<table>
  <tr>
    <th>Breaking Change</th>
    <th>Recommended Action</th>
  </tr>
  <tr>
    <td>You might experience a small amount of downtime during an upgrade to TAS for VMs v2.13. Downtime is more likely if you use Isolation Segments.</td>
    <td>Upgrade to the latest TAS for VMs patch.</td>
  </tr>
  <tr>
    <td>Log Cache uses syslog ingress by default.</td>
    <td>Confirm that your instances, including those within Isolation Segments, are permitted to establish connections to Log Cache nodes on port 6067. You might need to update firewall rules to allow logs to flow directly from your instances to the Log Cache syslog server.</td>
  </tr>
  <tr>
    <td>Underscaled Log Cache instances can fail with <code>Out of Memory</code> errors, which locks the BOSH Director.</td>
    <td>Scale up your Log Cache instance count. VMware recommends scaling up to match the number of VMs and amount of memory as your Doppler instances before the upgrade. Starting larger and then adjusting for actual use is safer than a deployment failure.</td>
  </tr>
  <tr>
    <td>Service instance metrics might not be retrievable using the <code>log-cache</code> cf CLI plugin.</td>
    <td>Use V2-based <code>log-cache</code> ingress to retrieve service metrics.</td>
  </tr>
</table>

### <a id='certs-require-san'></a> Gorouter Certificates Require a SAN Extension

In TAS for VMs v2.13, all Gorouter certificates require a valid subjectAltName (SAN) extension.
If any Gorouter certificates lack a SAN, Go clients cannot connect to servers and deployment fails.

Before you upgrade to TAS for VMs v2.13, you must:

  1. Verify that all certificates in Ops Manager use a valid SAN. If they do not, rotate your certificates using a valid SAN.
  1. Verify that all external systems that the Gorouter connects to have certificates with a valid SAN. If you use route services, this includes either the route services themselves or the load balancer in front of the route service.

If you need to complete a deployment before configuring new Gorouter certificates, select **Enable temporary workaround for certs without SANs** in the **Networking** pane of the TAS for VMs tile.

For more information about updating certificates, see [Routing and Golang 1.15 X.509 CommonName deprecation](https://community.pivotal.io/s/article/Routing-and-golang-1-15-X-509-CommonName-deprecation) in the Knowledge Base.

### <a id='ip-leading-zero'></a> Golang v1.17 Rejects IP Addresses with Leading Zeros

Golang v1.17 contains stricter IP parsing standards, so IP addresses with leading zeros in any octets cause a BOSH template failure.
Operators can remove the leading zeros and try deploying again.
This affects properties that feed into all releases that use Golang v1.17.
For a complete list, see [TAS for VMs Components Use Golang v1.17](#golang-1-17) above.
Syslog drains and metric registrar endpoints that are registered using user-provided services might also be affected.

### <a id='cf-cli-v6'></a> cf CLI v6 is Not Supported

TAS for VMs v2.13 does not support cf CLI v6. You must upgrade to cf CLI v7 or cf CLI v8.

To upgrade to a supported cf CLI version, see one of the following:

- [Upgrading to cf CLI v7](https://docs.pivotal.io/application-service/2-13/cf-cli/v7.html)
- [Upgrading to cf CLI v8](https://docs.pivotal.io/application-service/2-13/cf-cli/v8.html)


## <a id='known-issues'></a> Known Issues

TAS for VMs v2.13 currently has no known issues.
